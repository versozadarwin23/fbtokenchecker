<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Facebook Token Checker V3</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-blue: #007BFF;
      --secondary-gray: #495057;
      --background-dark: #212529;
      --card-dark: #2C3034;
      --text-light: #F8F9FA;
      --success-green: #28A745;
      --fail-red: #DC3545;
      --border-color: #495057;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Poppins', sans-serif;
      background: var(--background-dark);
      color: var(--text-light);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 20px;
    }
    .container {
      background: var(--card-dark);
      border: 1px solid var(--border-color);
      border-radius: 20px;
      box-shadow: 0 15px 30px rgba(0,0,0,0.4);
      width: 100%;
      max-width: 1000px;
      padding: 40px;
      display: flex;
      flex-direction: column;
      gap: 25px;
    }
    h2 {
      color: var(--primary-blue);
      margin-bottom: 10px;
      font-size: 2.2em;
      font-weight: 800;
      text-align: center;
    }

    .top-controls { margin-bottom: 15px; }
    input[type=file] {
      background: var(--secondary-gray);
      color: var(--text-light);
      border: 1px solid var(--border-color);
      border-radius: 10px;
      padding: 12px;
      font-size: 1em;
      width: 100%;
      cursor: pointer;
    }
    input[type=file]::file-selector-button {
      background: var(--primary-blue);
      color: #fff;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
    }
    input[type=file]::file-selector-button:hover { background: #0056b3; }

    #tokenCount {
      padding: 10px; border-radius: 8px; font-weight: 600; font-size: 1.1em; margin-bottom: 10px;
      background: rgba(255, 255, 255, 0.05);
      border-left: 3px solid var(--primary-blue);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    #checkIcon {
      display: none;
      color: var(--success-green);
      font-size: 1.2em;
      animation: check-fade-in 0.5s ease-in-out forwards;
    }

    @keyframes check-fade-in {
      from { opacity: 0; transform: scale(0.5); }
      to { opacity: 1; transform: scale(1); }
    }
    
    .panel h3 {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 1.2em;
      font-weight: 700;
      margin-bottom: 10px;
    }

    .results {
      display: flex;
      gap: 25px;
      flex: 1;
      margin: 15px 0;
    }
    .panel {
      flex: 1;
      display: flex;
      flex-direction: column;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 6px 12px rgba(0,0,0,0.3);
    }
    
    .panel-content {
      flex: 1;
      background: #242526;
      border-radius: 8px;
      padding: 15px;
      font-family: 'Poppins', sans-serif;
      font-size: 0.9em;
      overflow-y: hidden; 
      white-space: pre-wrap;
      word-break: break-all;
      max-height: 350px;
      line-height: 1.6;
    }
    
    .success-panel { border: 2px solid var(--success-green); }
    .success-panel h3 { color: var(--success-green); }
    .failed-panel { border: 2px solid var(--fail-red); }
    .failed-panel h3 { color: var(--fail-red); }

    .panel-content a {
      color: #58B0FF;
      text-decoration: none;
      transition: color 0.2s;
    }
    .panel-content a:hover {
      text-decoration: underline;
      color: #3B9AE2;
    }

    .button-group { display: flex; gap: 20px; flex-shrink: 0; }
    button {
      flex: 1; padding: 15px; border-radius: 10px; border: none;
      font-weight: 700; cursor: pointer; font-size: 1.1em; transition: 0.3s;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    #checkBtn { background: var(--primary-blue); color: #fff; }
    #checkBtn:hover:not(:disabled) { background: #0056b3; transform: translateY(-2px); }
    #downloadBtn { background: var(--success-green); color: #fff; }
    #downloadBtn:hover:not(:disabled) { background: #1E7E34; transform: translateY(-2px); }
    #clearBtn { background: var(--fail-red); color: #fff; }
    #clearBtn:hover:not(:disabled) { background: #B21F2D; transform: translateY(-2px); }
    button:disabled { background: var(--secondary-gray); cursor: not-allowed; box-shadow: none; }

    #progressBarContainer {
      width: 100%; background: var(--secondary-gray);
      border-radius: 8px; overflow: hidden; margin-top: 20px;
      display: none; flex-shrink: 0;
    }
    #progressBar {
      height: 30px; background: var(--success-green); width: 0%;
      text-align: center; line-height: 30px; font-size: 1em;
      color: var(--background-dark); font-weight: 700;
      transition: width 0.4s ease;
    }

    .social-links-container {
      margin-top: auto;
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 15px;
    }
    .social-links {
      display: flex;
      justify-content: center;
      gap: 25px;
    }
    .social-btn {
      width: 55px;
      height: 55px;
      display: flex;
      justify-content: center;
      align-items: center;
      border-radius: 50%;
      background: var(--secondary-gray);
      color: white;
      text-decoration: none;
      transition: transform 0.2s, background 0.3s;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    .social-btn:hover {
      transform: scale(1.1);
    }
    .social-btn.fb { background: #007BFF; }
    .social-btn.yt { background: #DC3545; }
    .social-btn.tg { background: #00A3D9; }

    .developer-info {
        font-size: 1em;
        text-align: center;
        color: var(--text-light);
        font-weight: 600;
        margin-top: 15px;
    }

    @media (max-width: 700px) {
      body { padding: 15px; }
      .container {
        padding: 20px;
        border-radius: 15px;
      }
      .results {
        flex-direction: column;
        gap: 15px;
      }
      .panel-content {
        max-height: 200px;
      }
      .button-group {
        flex-direction: column;
        gap: 10px;
      }
      .social-links {
        margin-top: 20px;
        gap: 15px;
      }
      .social-btn {
        width: 45px;
        height: 45px;
      }
      h2 { font-size: 1.8em; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>FB Token Checker V3</h2>

    <div class="top-controls">
      <input type="file" id="fileInput" accept=".txt">
    </div>

    <p id="tokenCount">Total tokens to check: <span id="remainingCount">0</span> <span id="checkIcon">‚úÖ</span></p>

    <div class="results">
      <div class="panel success-panel">
        <h3>
          <span>‚úÖ Success</span>
          <span id="successCount">0</span>
        </h3>
        <div class="panel-content" id="successList">No successes yet.</div>
      </div>
      <div class="panel failed-panel">
        <h3>
          <span>‚ùå Failed</span>
          <span id="failedCount">0</span>
        </h3>
        <div class="panel-content" id="failedList">No failures yet.</div>
      </div>
    </div>

    <div class="button-group">
      <button id="checkBtn">üöÄ Start Check</button>
      <button id="downloadBtn" disabled>üíæ Download CSV</button>
      <button id="clearBtn">üõë Stop/Reset</button>
    </div>

    <div id="progressBarContainer"><div id="progressBar">0%</div></div>

    <div class="social-links-container">
      <p style="font-size: 1.1em; font-weight: 600;">üë§ Developer Contact:</p>
      <p style="font-size: 0.9em; margin-top: -10px;">For feedback, questions, or updates, please check my social links:</p>
      <div class="social-links">
        <a href="https://www.facebook.com/darwinversoza139" target="_blank" class="social-btn fb">
          <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" viewBox="0 0 24 24">
            <path d="M22.675 0h-21.35C.597 0 0 .597 0 
            1.326v21.348C0 23.403.597 24 1.326 
            24H12.82v-9.294H9.692v-3.622h3.128V8.413c0-3.1 
            1.893-4.788 4.659-4.788 1.325 0 
            2.464.099 2.797.143v3.24l-1.922.001c-1.507 
            0-1.798.717-1.798 1.767v2.317h3.587l-.467 
            3.622h-3.12V24h6.116C23.403 24 24 
            23.403 24 22.674V1.326C24 
            .597 23.403 0 22.675 0z"/>
          </svg>
        </a>

        <a href="https://www.youtube.com/@darwinversoza" target="_blank" class="social-btn yt">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
            <path d="M23.498 6.186a2.974 
            2.974 0 00-2.092-2.104C19.505 
            3.5 12 3.5 12 3.5s-7.505 0-9.406.582a2.974 
            2.974 0 00-2.092 2.104C0 8.087 0 
            12 0 12s0 3.913.502 5.814a2.974 2.974 0 
            002.092 2.104C4.495 20.5 12 20.5 
            12 20.5s7.505 0 9.406-.582a2.974 
            2.974 0 002.092-2.104C24 15.913 
            24 12 24 12s0-3.913-.502-5.814zM9.75 
            15.568V8.432L15.818 12 9.75 
            15.568z"/>
          </svg>
        </a>

        <a href="https://t.me/versozadarwin" target="_blank" class="social-btn tg">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
            <path d="M9.999 16.2l-.401 
            5.6c.573 0 .823-.247 
            1.123-.544l2.694-2.588 
            5.59 4.089c1.022.566 
            1.744.27 1.998-.948l3.622-16.943.001.001c.322-1.5-.544-2.084-1.56-1.718L1.51 
            9.195c-1.477.573-1.455 1.386-.25 
            1.748l5.81 1.813 
            13.44-8.464-9.511 
            8.2z"/>
          </svg>
        </a>
      </div>
    </div>

    <p class="developer-info">Developed by **Dars: V3**</p>
  </div>

  <script>
    document.addEventListener('contextmenu', function(e) {
      e.preventDefault();
    });

    document.onkeydown = function(e) {
      if (e.key === 'F12') {
        e.preventDefault();
        return false;
      }

      if ((e.ctrlKey || e.metaKey) && e.shiftKey && (e.key === 'I' || e.key === 'i')) {
        e.preventDefault();
        return false;
      }

      if ((e.ctrlKey || e.metaKey) && e.shiftKey && (e.key === 'J' || e.key === 'j')) {
        e.preventDefault();
        return false;
      }

      if ((e.ctrlKey || e.metaKey) && (e.key === 'U' || e.key === 'u')) {
        e.preventDefault();
        return false;
      }
    };

    let results = [], totalTokens = 0, tokensChecked = 0;
    let successCount = 0, failedCount = 0;
    const fileInput = document.getElementById('fileInput');
    const tokenCountLabel = document.getElementById('tokenCount');
    const checkBtn = document.getElementById('checkBtn');
    const downloadBtn = document.getElementById('downloadBtn');
    const clearBtn = document.getElementById('clearBtn');
    const progressBarContainer = document.getElementById('progressBarContainer');
    const progressBar = document.getElementById('progressBar');
    const successList = document.getElementById('successList');
    const failedList = document.getElementById('failedList');
    const successCountLabel = document.getElementById('successCount');
    const failedCountLabel = document.getElementById('failedCount');
    const remainingCountLabel = document.getElementById('remainingCount');
    const checkIcon = document.getElementById('checkIcon');

    function autoScroll() {
      successList.scrollTop = successList.scrollHeight;
      failedList.scrollTop = failedList.scrollHeight;
    }

    function updateProgressBar() {
      if (totalTokens === 0) return;
      const pct = Math.round((tokensChecked / totalTokens) * 100);
      progressBar.style.width = pct + '%';
      progressBar.textContent = `${pct}% (${tokensChecked}/${totalTokens})`;

      remainingCountLabel.textContent = `${totalTokens - tokensChecked}`;

      if (tokensChecked === totalTokens) {
        progressBarContainer.style.display = 'none';
        checkBtn.disabled = false;
        downloadBtn.disabled = false;
        remainingCountLabel.textContent = `Done`;
        checkIcon.style.display = 'inline';
        checkBtn.textContent = 'üöÄ Start Check';
      }
    }

    fileInput.addEventListener('change', () => {
      if (!fileInput.files.length) return;
      const reader = new FileReader();
      reader.onload = () => {
        const lines = reader.result.split(/\r?\n/).filter(l => l.trim());
        totalTokens = lines.length;
        tokensChecked = 0;
        remainingCountLabel.textContent = `${totalTokens}`;
        checkIcon.style.display = 'none';
      };
      reader.readAsText(fileInput.files[0]);
    });

    clearBtn.addEventListener('click', () => {
      results = []; tokensChecked = 0; totalTokens = 0;
      successCount = 0; failedCount = 0;
      successCountLabel.textContent = '0';
      failedCountLabel.textContent = '0';
      successList.textContent = 'No successes yet.';
      failedList.textContent = 'No failures yet.';
      remainingCountLabel.textContent = '0';
      checkIcon.style.display = 'none';
      progressBarContainer.style.display = 'none';
      progressBar.style.width = '0%'; progressBar.textContent = '0%';
      downloadBtn.disabled = true; checkBtn.disabled = false;
      fileInput.value = '';
      checkBtn.textContent = 'üöÄ Start Check';

      successList.style.overflowY = 'hidden';
      failedList.style.overflowY = 'hidden';
    });

    downloadBtn.addEventListener('click', () => {
      let csvContent = "data:text/csv;charset=utf-8,";
      csvContent += "Email,Token,Status\n";

      const successResults = results.filter(item => item.status === 'Success');
      const failedResults = results.filter(item => item.status === 'Failed');

      successResults.forEach(item => {
        const row = [
          `"${item.email.replace(/"/g, '""')}"`,
          `"${item.token.replace(/"/g, '""')}"`,
          `"${item.status}"`
        ];
        csvContent += row.join(",") + "\n";
      });

      failedResults.forEach(item => {
        const row = [
          `"${item.email.replace(/"/g, '""')}"`,
          `"${item.token.replace(/"/g, '""')}"`,
          `"${item.status}"`
        ];
        csvContent += row.join(",") + "\n";
      });

      const encodedUri = encodeURI(csvContent);
      const link = document.createElement("a");
      link.setAttribute("href", encodedUri);
      link.setAttribute("download", "token_results.csv");
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    });

    // Ang async function na magche-check ng bawat token nang paisa-isa
    const checkToken = async (line) => {
      let email = 'N/A', token = line.trim();
      if (line.includes('|')) {
        const parts = line.split('|');
        email = parts[0].trim();
        token = parts[1]?.trim() || '';
      }

      let status = 'Failed';
      let responseMessage = 'Unknown Error';
      if (token) {
        try {
          const proxyUrl = 'https://api.allorigins.win/raw?url=';
          const apiRequestUrl = `https://graph.facebook.com/me?fields=id,email&access_token=${encodeURIComponent(token)}`;
          const res = await fetch(proxyUrl + encodeURIComponent(apiRequestUrl));
          const data = await res.json();
          if (data.id) {
            status = 'Success';
          } else if (data.error && data.error.message) {
            responseMessage = data.error.message;
          } else {
            responseMessage = 'Invalid API Response';
          }
        } catch (e) {
          responseMessage = 'Connection Error';
        }
      }
      return { email, token, status, responseMessage };
    };

    checkBtn.addEventListener('click', async () => {
      if (totalTokens === 0 || !fileInput.files.length) {
        return alert('‚ùå Please select a file.');
      }

      checkBtn.textContent = 'Checking...';
      checkBtn.disabled = true;

      successList.style.overflowY = 'auto';
      failedList.style.overflowY = 'auto';

      results = []; tokensChecked = 0;
      successCount = 0; failedCount = 0;
      successCountLabel.textContent = '0';
      failedCountLabel.textContent = '0';
      successList.textContent = '';
      failedList.textContent = '';

      downloadBtn.disabled = true;
      progressBarContainer.style.display = 'block';

      const reader = new FileReader();
      reader.onload = async () => {
        const lines = reader.result.split(/\r?\n/).filter(l => l.trim());
        totalTokens = lines.length;
        remainingCountLabel.textContent = `${totalTokens}`;

        const BATCH_SIZE = 5;
        const batches = [];
        for (let i = 0; i < totalTokens; i += BATCH_SIZE) {
          batches.push(lines.slice(i, i + BATCH_SIZE));
        }

        for (const batch of batches) {
          const promises = batch.map(line => checkToken(line));
          const batchResults = await Promise.all(promises);

          for (const result of batchResults) {
            results.push(result);
            const logEntry = document.createElement('div');
            const aTag = document.createElement('a');
            aTag.target = '_blank';
            aTag.textContent = 'Check Link';
            aTag.href = `https://developers.facebook.com/tools/debug/accesstoken/?access_token=${encodeURIComponent(result.token)}`;

            if (result.status === 'Success') {
              const textNode = document.createTextNode((result.email || 'N/A') + ' | ' + result.token.substring(0, 15) + '... - ');
              logEntry.appendChild(textNode);
              logEntry.appendChild(aTag);
              successList.appendChild(logEntry);
              successCount++;
            } else {
              const displayMessage = (result.responseMessage === 'Connection Error') ? 'Blocked' : result.responseMessage;
              const textNode = document.createTextNode((result.email || 'N/A') + ' | ' + result.token.substring(0, 15) + '... - ' + displayMessage + ' ');
              logEntry.appendChild(textNode);
              logEntry.appendChild(aTag);
              failedList.appendChild(logEntry);
              failedCount++;
            }

            tokensChecked++;
          }
          successCountLabel.textContent = successCount;
          failedCountLabel.textContent = failedCount;
          updateProgressBar();
          autoScroll();
        }

        tokensChecked = totalTokens;
        updateProgressBar();
        downloadBtn.disabled = false;
        progressBarContainer.style.display = 'none';
        checkBtn.textContent = 'üöÄ Start Check';
      };
      reader.readAsText(fileInput.files[0]);
    });
  </script>
</body>
</html>
